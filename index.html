<html>
  <head>
    <script src="jquery-1.11.1.min.js"></script>
    <script src="mustache.js"></script>
    <script type="text/javascript">
    
  			
  			var days = {
  				0: "Sunday",
  				1: "Monday",
  				2: "Tuesday",
  				3: "Wednesday",
  				4: "Thursday",
  				5: "Friday",
  				6: "Saturday"
  				
  			};
  			
  			function doCheckStuff() {
  				if (!navigator.geolocation) {
  					$("#infoStuff").html("<p>Sorry, but your browser does not support geolocation, thus this will not work.");
  					return;
  				}
  				
  				navigator.geolocation.getCurrentPosition(function(pos) {
  					var lat = pos.coords.latitude;
  					var long = pos.coords.longitude;
  					
  					$.ajax({
  						url: "template.html",
  						success: function(f, g, templObj) {
  							var mustacheTemplate = templObj.responseText;
  							
  							$.ajax({
  								url: "http://api.openweathermap.org/data/2.5/weather?lat=" + lat + "&lon=" + long,
  								success: function(a, b, obj) {
  									var txt = obj.responseText;
  							
  									var weather = JSON.parse(txt);
  							
  									var descObject = weather.weather[0];
  							
  									var desc = descObject.description;
  									var high = weather.main.temp_max - 273.15;
  									var low = weather.main.temp_min - 273.15;
  									
  									var d = new Date();
  									var timeString = d.toLocaleTimeString();
  									var day = d.getDay();
  									
  									var totalResponse = Mustache.render(mustacheTemplate, {
  										time: timeString,
  										weather_desc: desc,
  										temp_high: high,
  										temp_low: low,
  										day_of_week: days[day],
  										city_name: weather.name
  									});
  							
  									$("#infoStuff").html(totalResponse);
  								}
  							});
  						}
  					});
  					
  				});
  			}
  			$(navigator).ready(doCheckStuff);
  			setInterval(doCheckStuff, 10000);
  		
    </script>
  </head>
  <body>
    <p id="infoStuff">Hold tight, getting your information!</p>
  </body>
</html>
